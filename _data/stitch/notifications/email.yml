# -------------------------- #
#     EMAIL NOTIFICATIONS    #
# -------------------------- #


# -------------------------- #
#        INTEGRATIONS        #
# -------------------------- #

- id: "integration"
  app-id: "integration"
  category: "integration"
  name: "Integration"
  description: |
    Sent when Stitch encounters issues connecting to or replicating data from an integration. 
  delay: "20 minutes"
  subject-lines: 
    - &int-subject "We're encountering some errors with your `<integration display name>` integration"
    - "Integration API Rate Limited"
  potential-causes: 
    - "Connection issues between Stitch and the integration"
    - "Insufficient API quota"
    - "Incorrect user credentials"
    - "Insufficient user permissions"
  sent-to: "all"
  related-types:
    - "integration_api_limit"
    - "integration_auth_error"
    - "db_replicator_absent_bookmark" # occurs when the replication key for a table is deleted in the source

# -------------------------- #
#         EXTRACTIONS        #
# -------------------------- #

- id: "extraction-error"
  app-id: "platform.exit_status"
  category: "replication"
  name: "Extraction"
  description: "Sent when Stitch encounters issues during the Extraction phase of the replication process."
  delay: "60 minutes"
  subject-lines: 
    - *int-subject
  potential-causes:
    - "Connection issues between Stitch and the integration"
    - "Incorrect user credentials"
    - "Insufficient user permissions"
    - "Unsupported field or data type(s)"
    - "Incorrectly configured Log-based Replication (databases only)"
  sent-to: "all"
  related-types:
    - "platform.error"

# -------------------------- #
#       LOADING ERRORS       #
# -------------------------- #

- id: "loading-error"
  app-id: "read_head"
  category: "replication"
  name: "Data loading"
  description: |
    Sent when Stitch encounters issues loading data to the account's destination. These issues must be resolved before Stitch will be able to successfully load data. 
  delay: "2 hours"
  subject-lines:
    - "We're having trouble writing to your data warehouse"
    - "We're unable to load some of your data"
    - "Stitch cannot load data into your destination"
  potential-causes:
    - "Connection issues between Stitch and the destination"
    - "Incorrect user credentials"
    - "Insufficient user permissions"
    - "The destination is out of memory"
  sent-to: "all"
  related-types:
    - "loader_warehouse_error"
    - "jammed_read_head"
    - "loader_tunnel_error"
    # - "warehouse_table_view_creation_failed" # From the Redshift view days
    - "warehouse_internal_error"
    - "warehouse_bulk_load_failed"
    - "warehouse_connection_failed"
    - "warehouse_connection_authentication_failed"
    - "warehouse_no_connection_configured"

# -------------------------- #
#   INTERNAL LOADING ERRORS  #
# -------------------------- #

- id: "internal-loader-error"
  app-id: "loader-internal-error"
  category: "destination"
  name: "Stitch loading"
  description: "Sent when an internal Stitch issue has prevented successful data loads to your destination. Stitch will automatically retry loading until the issue is resolved."
  delay: "3 hours"
  subject-lines:
    - "Data delays"
  potential-causes:
    - "Internal Stitch issues or outages"
  sent-to: "all"
  related-types:
    - "loader_internal_error"

# -------------------------- #
#        VACUUM ERRORS       #
# -------------------------- #

- id: "vacuum"
  app-id: "vacuum"
  category: "vacuum"
  name: "Amazon Redshift VACUUM"
  description: |
    **Applicable only to Amazon Redshift destinations.** Sent when Stitch hasn't successfully performed a `VACUUM` operation on tables in your Amazon Redshift destination.
  delay: "10 days"
  subject-lines: 
    - "Weâ€™ve been unable to VACUUM for awhile"
  potential-causes:
    - "Stitch has not successfully performed a `VACUUM` operation in more than 10 days."
  sent-to: "all"
  related-types:
    - "loader_warehouse_error"

# -------------------------- #
#       INACTIVE CLIENT      #
# -------------------------- #

- id: "inactive-client"
  app-id: "defunct_client"
  category: "account"
  name: "Inactivity"
  description: "Sent when data has not been loaded into the account's destination for more than 40 days."
  delay: "n/a"
  subject-lines: 
    - "Integrations Paused due to Account Inactivity"
  potential-causes:
    - "No data loaded to destination in more than 40 days."
  sent-to: "all"
  related-types:
    - "defunt_client"

# -------------------------- #
#          USAGE             #
# -------------------------- #
- id: "usage"
  app-id: "usage"
  category: "account"
  name: "Row usage"
  description: "Sent when the usage for the current billing period reaches 70, 90, and 100% of the account's row limit."
  delay: "None"
  subject-lines:
    - "Approaching Row Limit"
    - "Row Limit Reached"
  potential-causes:
    - "Row usage for the account reaches 70, 90, or 100% of the account's row limit."
  related-types:
    - "usage_nearing_limit_70"
    - "usage_nearing_limit_90"
    - "usage_reached_limit"


# -------------------------- #
#        CONNECTIONS         #
# -------------------------- #
# - id: "connection"
#   app-id: "connection"
#   category: "connection"
#   name: "Connection"
#   description: "Sent when Stitch encounters a connection issue for a source or destination."
#   subject-lines:
#     - ""
#   examples:
#     - ""
#   related-types:
    # - "connection_credentials_error"
    # - "connection_max_connections" 
    # - "connection_db_read_error" 
    # - "connection_table_read_error" # last sent in Jan 2017
    # - "connection_failed" # last sent in 2017
    # - "connection_no_schema_rights" 


# -------------------------- #
#          PAYMENTS          #
# -------------------------- #

# - id: "payment"
#   app-id: "payment"
#   category: "account"
#   name: "Payment"
#   description: "Sent when there is a problem with the account's payment method or the Stitch account is past due."
#   delay: ""
#   subject-lines:
#     - ""
#   sent-to: "all"
#   related-types:
#     - "payment_overdue"
#     - "payment_failed"

# -------------------------- #
#    FREE TRIAL EXPIRATION   #
# -------------------------- #

# - id: "plan"
#   app-id: "plan"
#   category: "account"
#   name: "Free trial expiration"
#   description: "Sent when the account's free trial period has ended."
#   subject-lines:
#     - ""
#   sent-to: "all"
#   related-types:
#     - "plan_free_trial_expired"